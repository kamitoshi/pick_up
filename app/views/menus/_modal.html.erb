<div class="container">
  <div class="row">
    <div class="col-12">
      <div class="modal fade" id="modal<%= menu.id %>" tabindex="-1" aria-labelledby="exampleModalLabel">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content container">
            <div class="modal-body">
              <div class="row">
                <div class="col-md-12 center">
                  <% if menu.menu_images.present? %>
                    <%= image_tag menu.menu_images[0].file_name.thumb_square.to_s, id:"sample_img", class: "wid-70" %>
                  <% else %>
                    <%= image_tag "noimage.png", class: "wid-100" %>
                  <% end %>
                </div>
              </div>
              <div class="row">
                <div class="col-4">
                  <h5><%= menu.name %></h5>
                  <h6><%= menu.shop.name %></h6>
                </div>
                <div class="col-8">
                  <p><%= menu.introduction %></p>
                </div>
              </div>
            </div>
            
            <div class="modal-foot ma-b-20">
              <hr>
              <%= form_for CartItem.new, url: menu_cart_items_path(menu) do |f| %>
                <%= f.hidden_field :menu_id, value: menu.id %>
                <div class="row">
                  <div class="col-sm-3 center" style="padding-top: 0.8rem;">
                    <span id="minusButton<%= menu.id %>" class="pointer minusBtn">-</span><%= f.text_field :amount, id: "counterOutput#{menu.id}", class:"amount_input", value:1 %><span id="plusButton<%= menu.id %>" class="pointer plusBtn">+</span>
                  </div>
                  <div class="col-sm-8 border-r">
                    <div class="actions center">
                      <%= f.submit "カートに追加する", class: "button-fill" %>
                      <%= link_to "今すぐ注文する", new_menu_order_path(menu), class: "button-fill" %>
                    </div>
                  </div>
                  <div class="col-sm-1" style="padding-top: 0.8rem;">
                    <button type="button" class="close" data-dismiss="modal" aria-label="閉じる" class="ma-t-10">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                </div>
              <% end %>
            </div>
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->
    </div>
  </div>
</div>

<script>
  let counterOutput<%= menu.id %> = document.getElementById("counterOutput<%= menu.id %>");
  // 加算機能
  let plusButton<%= menu.id %> = document.getElementById("plusButton<%= menu.id %>");
  let onClickPlusButton<%= menu.id %> = () => {
    counterOutput<%= menu.id %>.value++;
  };
  plusButton<%= menu.id %>.addEventListener("click", onClickPlusButton<%= menu.id %>);

  // 減算機能
  let minusButton<%= menu.id %> = document.getElementById("minusButton<%= menu.id %>");
  let onClickMinusButton<%= menu.id %> = () => {
    if (counterOutput<%= menu.id %>.value > 1) {
      counterOutput<%= menu.id %>.value--; // カウント数が1以上のときだけ減算する
    }
  };
  minusButton<%= menu.id %>.addEventListener("click", onClickMinusButton<%= menu.id %>);

  // slide用
  let image<%= menu.id %> = document.getElementById("image<%= menu.id %>");
  let image<%= menu.id %>_num = 0;
  let image<%= menu.id %>_count = <%= menu.menu_images.count %>;

  // back
  let backButton<%= menu.id %> = document.getElementById("backButton<%= menu.id %>");
  let onClickBackButton<%= menu.id %> = () => {
    let num = image<%= menu.id %>_num;
    if(image<%= menu.id %>_num == 0){
      image<%= menu.id %>_num = image<%= menu.id %>_count - 1;
    }else{
      image<%= menu.id %>_num ++;
    }
    console_log("ok");
  };
  backButton<%= menu.id %>.addEventListener("click", onClickBackButton<%= menu.id %>);
</script>